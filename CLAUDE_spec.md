# CLAUDE.md 補足仕様書 - 設計書作成ガイドライン

## 1. 設計書作成時の重要な注意点

### 1.1 最初に明確にすべきこと

#### ❌ 悪い例：いきなり技術的な解決策から始める
```markdown
# 設計書

## 1. 設計レビューと問題点の分析
### 1.1 初期設計の問題点
- 型安全性の欠如
- スケーラビリティの問題
```

#### ✅ 良い例：目的と課題を明確にしてから始める
```markdown
# 設計書

## 0. 概要と目的
### 0.1 本設計書の目的
本設計書は、[具体的な機能名]の設計を定めるものです。

### 0.2 解決したい課題
[なぜこの機能が必要なのか、現状の問題点]

### 0.3 具体的なユースケース
[実際の使用例を具体的に記載]
```

### 1.2 具体例の重要性

#### 必ず含めるべき要素
1. **実際のコード例**
   - 対象となるクラスの定義
   - 実際のデータ構造

2. **データの例**
   - テーブル形式での表現
   - Before/Afterの明示

3. **操作の例**
   - 「○○を××に変更する」という具体的な操作

### 1.3 設計の深さと実装の現実性のバランス

#### 段階的アプローチの明記
```markdown
## 実装ロードマップ

### Phase 1: MVP（最小実装）- 1週間
- 基本的な単一フィールド更新
- 簡単なUI
- 基本的なエラーハンドリング

### Phase 2: 本格実装 - 2週間
- Expression Treeによる型安全性
- バッチ処理
- 差分確認UI

### Phase 3: エンタープライズ機能 - 2週間
- 権限管理
- 監査ログ
- 高度なエラーリカバリー
```

## 2. 設計書の構成テンプレート

### 推奨される章立て

```markdown
# [機能名] 設計書

## 0. 概要と目的
- 本設計書の目的
- 解決したい課題
- 具体的なユースケース（コード例付き）

## 1. 機能要件
- 必須要件（番号付きリスト）
- 将来の拡張要件

## 2. 設計方針と課題分析
- 考えられるアプローチの比較
- 選択した方針の理由

## 3. アーキテクチャ設計
- 全体構成図
- レイヤー構成
- データフロー

## 4. 詳細設計
- 主要コンポーネントの設計
- インターフェース定義
- 実装例

## 5. UI/UX設計
- 画面イメージ（アスキーアート可）
- 操作フロー

## 6. エラーハンドリング
- エラーの分類
- ユーザーへの表示方法

## 7. テスト戦略
- 単体テストの例
- 統合テストのシナリオ

## 8. パフォーマンス考慮
- 想定される負荷
- 最適化戦略

## 9. 実装ロードマップ
- 段階的な実装計画
- 各フェーズの成果物

## 10. リスクと対策
- 技術的リスク
- 対策案

## 11. 具体的な使用例
- 基本的な使用例（コード付き）
- 応用例
- テストコード例

## 12. まとめ
- 要件との対応表（✅チェックリスト）
- 実現される価値
```

## 3. 設計プロセスのベストプラクティス

### 3.1 Think Harder の実践方法

1. **初期設計を批判的にレビュー**
   - 「この設計の問題点は何か？」を自問
   - スケーラビリティ、保守性、拡張性の観点で評価

2. **複数の解決策を検討**
   - 最低3つのアプローチを比較
   - それぞれのメリット・デメリットを明記

3. **実装の現実性を確認**
   - MVPで価値を提供できるか
   - 段階的に機能追加可能か

### 3.2 補足資料の活用

メイン設計書で書ききれない詳細は補足資料に：
- 詳細な実装パターン
- エッジケースの処理
- パフォーマンス最適化の詳細
- セキュリティ考慮事項

## 4. よくある間違いと対策

### 4.1 ❌ 過度に技術的な設計
**問題**: Expression Tree、3-wayマージなど高度な技術から始める
**対策**: まず簡単な実装（文字列ベース）から始め、段階的に改善

### 4.2 ❌ 具体例の不足
**問題**: 抽象的な説明のみで実際の使用イメージが湧かない
**対策**: 必ず実際のクラス、データ、操作例を含める

### 4.3 ❌ 実装難易度の過小評価
**問題**: 「簡単に実装できる」と楽観的に記載
**対策**: 具体的な工数見積もりとリスクを明記

## 5. 設計書レビューチェックリスト

設計書完成時に確認すべき項目：

- [ ] 目的と解決したい課題が明確か
- [ ] 具体的なユースケースがあるか
- [ ] 実際のコード例が含まれているか
- [ ] データの具体例（テーブル等）があるか
- [ ] 段階的な実装計画があるか
- [ ] テストコードの例があるか
- [ ] エラーハンドリングが考慮されているか
- [ ] 要件との対応が明確か（チェックリスト形式）
- [ ] 実装者が迷わない程度に具体的か

## 6. ドキュメントの配置

### 正しい配置場所
```
Packages/SheetSync/Documentation/
├── DESIGN_[機能名].md              # メイン設計書
├── DESIGN_[機能名]_Supplement.md   # 補足資料
└── IMPLEMENTATION_[機能名].md      # 実装ガイド（必要に応じて）
```

### 注意点
- プロジェクトルート直下の`Documentation/`ではなく、パッケージ内の`Documentation/`に配置
- git管理されていることを確認
- 関連する設計書は名前で関連性を示す

## 7. 最後に

良い設計書は：
1. **読者が目的を即座に理解できる**
2. **具体例で使用イメージが明確**
3. **段階的に実装可能**
4. **テスト可能**
5. **将来の拡張が考慮されている**

これらの点を意識して設計書を作成することで、実装者にとって価値のあるドキュメントとなります。